<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stephen King Complete Bibliography</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: white;
            min-height: 100vh;
        }
        
        .container {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
            border: 1px solid rgba(255, 255, 255, 0.18);
        }
        
        h1 {
            text-align: center;
            margin-bottom: 10px;
            font-size: 2.5em;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .subtitle {
            text-align: center;
            margin-bottom: 30px;
            opacity: 0.8;
            font-size: 1.1em;
        }
        
        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin: 20px 0;
            text-align: center;
        }
        
        .stat {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 10px;
            transition: transform 0.3s ease;
        }
        
        .stat:hover {
            transform: translateY(-5px);
            background: rgba(255, 255, 255, 0.15);
        }
        
        .stat-number {
            font-size: 2em;
            font-weight: bold;
            display: block;
            color: #4ecdc4;
        }
        
        .stat-label {
            font-size: 0.9em;
            opacity: 0.8;
            margin-top: 5px;
        }
        
        .filters {
            display: flex;
            gap: 10px;
            margin: 20px 0;
            flex-wrap: wrap;
            justify-content: center;
        }
        
        .filter-btn {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.3);
            padding: 8px 16px;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9em;
        }
        
        .filter-btn:hover, .filter-btn.active {
            background: rgba(255, 255, 255, 0.2);
            border-color: #4ecdc4;
            color: #4ecdc4;
        }
        
        .book-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 20px;
            margin: 20px 0;
            max-height: 500px;
            overflow-y: auto;
            overflow-x: visible;
            padding: 20px;
            background: rgba(0, 0, 0, 0.1);
            border-radius: 15px;
        }
        
        .book-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 15px;
            transition: all 0.3s ease;
            border-left: 4px solid transparent;
            position: relative;
            cursor: pointer;
            overflow: visible;
        }

        .book-card:hover {
            background: rgba(255, 255, 255, 0.15);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
        }

        .book-tooltip {
            position: fixed;
            background: rgba(0, 0, 0, 0.95);
            color: white;
            padding: 15px;
            border-radius: 8px;
            border: 2px solid #4ecdc4;
            max-width: 350px;
            font-size: 14px;
            line-height: 1.4;
            z-index: 10000;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s ease;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        }

        .book-tooltip.show {
            opacity: 1;
        }

        .tooltip-title {
            font-weight: bold;
            margin-bottom: 8px;
            color: #4ecdc4;
        }

        .tooltip-plot {
            margin-bottom: 10px;
        }

        .tooltip-facts {
            font-size: 12px;
            opacity: 0.9;
            border-top: 1px solid rgba(78, 205, 196, 0.3);
            padding-top: 8px;
        }
        
        .book-card.novel { border-left-color: #e74c3c; }
        .book-card.collection { border-left-color: #3498db; }
        .book-card.nonfiction { border-left-color: #2ecc71; }
        .book-card.novella { border-left-color: #f39c12; }
        .book-card.bachman { border-left-color: #9b59b6; }
        
        .book-title {
            font-weight: bold;
            margin-bottom: 5px;
            font-size: 1.1em;
        }
        
        .book-meta {
            font-size: 0.9em;
            opacity: 0.8;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .book-type {
            background: rgba(255, 255, 255, 0.2);
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 0.8em;
        }
        
        .download-section {
            text-align: center;
            margin: 30px 0;
        }
        
        .download-btn {
            background: linear-gradient(45deg, #4ecdc4, #44a08d);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            font-size: 1.1em;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin: 0 10px;
        }
        
        .download-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 35px rgba(0, 0, 0, 0.3);
        }
        
        .note {
            background: rgba(52, 152, 219, 0.2);
            border-left: 4px solid #3498db;
            padding: 15px;
            margin: 20px 0;
            border-radius: 5px;
            font-size: 0.95em;
            line-height: 1.5;
        }
        
        .search-box {
            width: 100%;
            max-width: 400px;
            padding: 12px 20px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 25px;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            font-size: 1em;
            margin: 0 auto 20px;
            display: block;
        }
        
        .search-box::placeholder {
            color: rgba(255, 255, 255, 0.6);
        }
        
        .search-box:focus {
            outline: none;
            border-color: #4ecdc4;
        }
        
        /* Scrollbar styles */
        .book-grid::-webkit-scrollbar {
            width: 8px;
        }
        
        .book-grid::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
        }
        
        .book-grid::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.3);
            border-radius: 10px;
        }
        
        .book-grid::-webkit-scrollbar-thumb:hover {
            background: rgba(255, 255, 255, 0.5);
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ðŸ“š Stephen King Complete Bibliography</h1>
        <div class="subtitle">All Published Works with Hover Details</div>
        
        <div class="stats" id="stats">
            <!-- Stats will be populated by JavaScript -->
        </div>
        
        <input type="text" id="searchBox" class="search-box" placeholder="Search books by title...">
        
        <div class="filters">
            <button class="filter-btn active" data-filter="all">All Books</button>
            <button class="filter-btn" data-filter="novel">Novels</button>
            <button class="filter-btn" data-filter="collection">Collections</button>
            <button class="filter-btn" data-filter="novella">Novellas</button>
            <button class="filter-btn" data-filter="nonfiction">Non-Fiction</button>
            <button class="filter-btn" data-filter="bachman">Bachman Books</button>
        </div>
        
        <div class="book-grid" id="bookGrid">
            <!-- Books will be populated here -->
        </div>
        
        <div class="note">
            <strong>ðŸ’¡ Try hovering over any book card to see plot details and publication facts!</strong><br>
            Data compiled from Stephen King's official website. Includes novels, novellas, short story collections, non-fiction works, and Richard Bachman books.
        </div>
        
        <div class="download-section">
            <button class="download-btn" onclick="downloadExcel('all')">
                ðŸ“¥ Download Complete List
            </button>
            <button class="download-btn" onclick="downloadExcel('filtered')" id="filteredDownload">
                ðŸ“‹ Download Filtered List
            </button>
        </div>
    </div>

    <script>
        // Complete Stephen King bibliography with hover information
        const stephenKingBooks = [
            // Novels
            { Title: "Carrie", Type: "Novel", Date: "April 5, 1974", Category: "novel", Year: 1974, 
              Plot: "A telekinetic teenager faces high school bullying and religious extremism, leading to a devastating prom night.", 
              Facts: "King's debut novel â€¢ Adapted into multiple films â€¢ Almost discarded by King but rescued by his wife Tabitha" },
            { Title: "'Salem's Lot", Type: "Novel", Date: "October 17, 1975", Category: "novel", Year: 1975,
              Plot: "Vampires invade a small Maine town, turning residents into undead creatures.",
              Facts: "King's second novel â€¢ Inspired by Bram Stoker's Dracula â€¢ Set in fictional Jerusalem's Lot, Maine" },
            { Title: "The Shining", Type: "Novel", Date: "January 1977", Category: "novel", Year: 1977,
              Plot: "A family becomes winter caretakers of an isolated hotel where supernatural forces drive the father toward madness.",
              Facts: "Inspired by King's stay at The Stanley Hotel â€¢ Famously adapted by Stanley Kubrick â€¢ King wrote the screenplay for 1997 miniseries" },
            { Title: "The Stand", Type: "Novel", Date: "October 1978", Category: "novel", Year: 1978,
              Plot: "After a plague wipes out most of humanity, survivors gather to face a final battle between good and evil.",
              Facts: "Originally 823 pages, expanded to 1,152 in 1990 â€¢ King considers it his 'Lord of the Rings' â€¢ Features over 1000 characters" },
            { Title: "The Dead Zone", Type: "Novel", Date: "August 1979", Category: "novel", Year: 1979,
              Plot: "A man awakens from a coma with psychic abilities that allow him to see the future through touch.",
              Facts: "First King novel to be planned from start to finish â€¢ Adapted into film (1983) and TV series â€¢ Explores themes of power and responsibility" },
            { Title: "Firestarter", Type: "Novel", Date: "September 29, 1980", Category: "novel", Year: 1980,
              Plot: "A young girl with pyrokinetic abilities is hunted by a government agency that wants to weaponize her powers.",
              Facts: "Serialized in Omni magazine â€¢ Drew Barrymore starred in 1984 film adaptation â€¢ King's critique of government overreach" },
            { Title: "Cujo", Type: "Novel", Date: "September 8, 1981", Category: "novel", Year: 1981,
              Plot: "A rabid St. Bernard traps a mother and son in their car during a sweltering summer.",
              Facts: "King was so affected by cocaine addiction he doesn't remember writing it â€¢ One of his most claustrophobic novels â€¢ No supernatural elements" },
            { Title: "Christine", Type: "Novel", Date: "April 29, 1983", Category: "novel", Year: 1983,
              Plot: "A 1958 Plymouth Fury develops a murderous obsession with its teenage owner.",
              Facts: "Explores teenage alienation and toxic relationships â€¢ John Carpenter directed the 1983 film â€¢ King's commentary on American car culture" },
            { Title: "Pet Sematary", Type: "Novel", Date: "November 1983", Category: "novel", Year: 1983,
              Plot: "A family discovers an ancient burial ground where the dead return to life, but they come back wrong.",
              Facts: "King considered it too frightening to publish â€¢ Inspired by a real pet cemetery near King's home â€¢ Explores grief and letting go" },
            { Title: "The Talisman", Type: "Novel", Date: "November 1984", Category: "novel", Year: 1984,
              Plot: "A 12-year-old boy journeys across America and a parallel world to save his dying mother.",
              Facts: "Co-written with Peter Straub â€¢ Combines fantasy and horror â€¢ Sequel 'Black House' published in 2001" },
            { Title: "IT", Type: "Novel", Date: "September 1986", Category: "novel", Year: 1986,
              Plot: "Seven children face an ancient evil that preys on the town of Derry every 27 years.",
              Facts: "One of King's longest novels at 1,138 pages â€¢ Explores childhood trauma and memory â€¢ Highly successful 2017/2019 film adaptations" },
            { Title: "The Eyes of the Dragon", Type: "Novel", Date: "February 1987", Category: "novel", Year: 1987,
              Plot: "A young prince must escape from prison to reclaim his throne in a medieval fantasy setting.",
              Facts: "King's first pure fantasy novel â€¢ Written for his children â€¢ Set in the same universe as The Dark Tower" },
            { Title: "Misery", Type: "Novel", Date: "June 1987", Category: "novel", Year: 1987,
              Plot: "A writer is held captive by his 'number one fan' who forces him to write a novel to her specifications.",
              Facts: "King's allegory for his own addiction struggles â€¢ Kathy Bates won Oscar for 1990 film adaptation â€¢ Explores the relationship between writers and readers" },
            { Title: "The Tommyknockers", Type: "Novel", Date: "November 1987", Category: "novel", Year: 1987,
              Plot: "Residents of a small town are transformed by an alien presence buried in the forest.",
              Facts: "King wrote this during peak cocaine addiction â€¢ He considers it one of his worst books â€¢ Explores themes of technology and addiction" },
            { Title: "The Dark Half", Type: "Novel", Date: "November 1989", Category: "novel", Year: 1989,
              Plot: "A writer's violent pseudonym comes to life and begins killing people who threaten to expose the secret.",
              Facts: "Inspired by King's own experience writing as Richard Bachman â€¢ Explores duality and artistic identity â€¢ Features real sparrows in climactic scene" },
            { Title: "Needful Things", Type: "Novel", Date: "October 1991", Category: "novel", Year: 1991,
              Plot: "A mysterious shop owner grants people's deepest desires in exchange for small favors that turn the town against itself.",
              Facts: "Billed as 'The Last Castle Rock Story' â€¢ Explores greed and human weakness â€¢ Features characters from previous King novels" },
            { Title: "Gerald's Game", Type: "Novel", Date: "May 1992", Category: "novel", Year: 1992,
              Plot: "A woman becomes trapped by handcuffs during an intimate game gone wrong and must survive using only her wits.",
              Facts: "Written as a psychological thriller â€¢ One of King's most claustrophobic novels â€¢ Successful Netflix adaptation in 2017" },
            { Title: "Dolores Claiborne", Type: "Novel", Date: "November 1993", Category: "novel", Year: 1993,
              Plot: "A housekeeper confesses to murder while revealing the truth about her abusive marriage and her employer's death.",
              Facts: "Told entirely in first person â€¢ No chapters or section breaks â€¢ Connected to Gerald's Game through solar eclipse" },
            { Title: "Insomnia", Type: "Novel", Date: "September 1994", Category: "novel", Year: 1994,
              Plot: "An elderly man's chronic insomnia reveals a supernatural battle between forces of good and evil.",
              Facts: "Connects to The Dark Tower mythology â€¢ Explores aging and mortality â€¢ Features 'little bald doctors' from other dimensions" },
            { Title: "Rose Madder", Type: "Novel", Date: "June 1995", Category: "novel", Year: 1995,
              Plot: "A battered wife escapes her abusive police officer husband and finds refuge through a magical painting.",
              Facts: "King's exploration of domestic violence â€¢ Blends realistic drama with fantasy elements â€¢ Features Greek mythology themes" },
            { Title: "Bag of Bones", Type: "Novel", Date: "September 22, 1998", Category: "novel", Year: 1998,
              Plot: "A widowed novelist returns to his lake house where he encounters ghosts and uncovers a town's dark secrets.",
              Facts: "Won Bram Stoker Award â€¢ King's meditation on grief and loss â€¢ Features actual lyrics from blues songs" },
            { Title: "The Girl Who Loved Tom Gordon", Type: "Novel", Date: "April 1999", Category: "novel", Year: 1999,
              Plot: "A nine-year-old girl becomes lost in the woods and imagines her baseball hero helping her survive.",
              Facts: "One of King's shortest novels â€¢ Based on real Red Sox pitcher â€¢ Explores childhood resilience and imagination" },
            { Title: "Dreamcatcher", Type: "Novel", Date: "February 20, 2001", Category: "novel", Year: 2001,
              Plot: "Four friends with psychic abilities battle an alien invasion in the Maine woods.",
              Facts: "Written while King recovered from his van accident â€¢ King admits he was heavily medicated during writing â€¢ Criticized by King himself" },
            { Title: "Black House", Type: "Novel", Date: "September 15, 2001", Category: "novel", Year: 2001,
              Plot: "Retired detective Jack Sawyer returns to investigate child murders connected to The Dark Tower.",
              Facts: "Sequel to The Talisman â€¢ Co-written with Peter Straub â€¢ Bridges Dark Tower mythology with detective fiction" },
            { Title: "From A Buick 8", Type: "Novel", Date: "September 24, 2002", Category: "novel", Year: 2002,
              Plot: "State troopers guard a mysterious car that serves as a portal to another dimension.",
              Facts: "Meditation on loss and growing up â€¢ Told through multiple perspectives â€¢ Features no clear resolution" },
            { Title: "The Colorado Kid", Type: "Novel", Date: "October 2005", Category: "novel", Year: 2005,
              Plot: "Two newspapermen tell a young reporter about an unsolved mystery involving a dead man on a beach.",
              Facts: "Published by Hard Case Crime â€¢ No resolution provided â€¢ Inspired TV series Haven" },
            { Title: "Cell", Type: "Novel", Date: "January 24, 2006", Category: "novel", Year: 2006,
              Plot: "A mysterious cell phone signal turns users into zombie-like creatures, sparking an apocalypse.",
              Facts: "King's take on zombie fiction â€¢ Explores technology dependence â€¢ Film adaptation starred John Cusack" },
            { Title: "Lisey's Story", Type: "Novel", Date: "October 2006", Category: "novel", Year: 2006,
              Plot: "A widow discovers her late husband's supernatural secret world while sorting through his belongings.",
              Facts: "King's personal favorite of his novels â€¢ Love letter to his wife Tabitha â€¢ Won Bram Stoker Award" },
            { Title: "Duma Key", Type: "Novel", Date: "January 22, 2008", Category: "novel", Year: 2008,
              Plot: "An artist recovering from an accident discovers his paintings have supernatural power on a Florida island.",
              Facts: "Set in Florida instead of Maine â€¢ Explores art and healing â€¢ Features Edgar Freemantle's recovery journey" },
            { Title: "Under the Dome", Type: "Novel", Date: "November 2009", Category: "novel", Year: 2009,
              Plot: "A small town becomes trapped under an invisible dome, revealing the corruption and violence within.",
              Facts: "1,072 pages long â€¢ Adapted into CBS series â€¢ Explores political corruption and environmental themes" },
            { Title: "11/22/63", Type: "Novel", Date: "November 8, 2011", Category: "novel", Year: 2011,
              Plot: "A teacher travels back in time to prevent JFK's assassination but discovers changing history has consequences.",
              Facts: "Extensive historical research â€¢ Won LA Times Book Prize â€¢ Hulu miniseries starring James Franco" },
            { Title: "Joyland", Type: "Novel", Date: "June 2013", Category: "novel", Year: 2013,
              Plot: "A college student working at an amusement park investigates a murder and encounters a psychic child.",
              Facts: "Published only in paperback initially â€¢ Coming-of-age story â€¢ Set in 1973 North Carolina" },
            { Title: "Doctor Sleep", Type: "Novel", Date: "September 24, 2013", Category: "novel", Year: 2013,
              Plot: "Adult Danny Torrance battles his alcoholism while protecting a psychic girl from a cult that feeds on 'shine.'",
              Facts: "Sequel to The Shining â€¢ Explores addiction and recovery â€¢ 2019 film directed by Mike Flanagan" },
            { Title: "Mr. Mercedes", Type: "Novel", Date: "June 2014", Category: "novel", Year: 2014,
              Plot: "A retired detective hunts a killer who drove into a crowd of job seekers with a stolen Mercedes.",
              Facts: "First in Bill Hodges trilogy â€¢ Won Edgar Award â€¢ AT&T Audience Network series" },
            { Title: "Revival", Type: "Novel", Date: "November 2014", Category: "novel", Year: 2014,
              Plot: "A man's lifelong relationship with a minister leads to a terrifying revelation about the afterlife.",
              Facts: "Influenced by Mary Shelley's Frankenstein â€¢ Explores faith and science â€¢ King's most pessimistic ending" },
            { Title: "Finders Keepers", Type: "Novel", Date: "June 2, 2015", Category: "novel", Year: 2015,
              Plot: "A teenager finds stolen money hidden by a literary obsessed killer and becomes entangled in murder.",
              Facts: "Second Bill Hodges trilogy book â€¢ Explores literary fandom â€¢ Features John Rothstein character" },
            { Title: "End of Watch", Type: "Novel", Date: "June 7, 2016", Category: "novel", Year: 2016,
              Plot: "Detective Hodges faces his nemesis one final time as Mr. Mercedes gains psychic powers.",
              Facts: "Concludes Bill Hodges trilogy â€¢ Introduces supernatural elements â€¢ Won Goodreads Choice Award" },
            { Title: "Sleeping Beauties", Type: "Novel", Date: "September 26, 2017", Category: "novel", Year: 2017,
              Plot: "Women around the world fall into a mysterious sleep, leaving men to maintain civilization alone.",
              Facts: "Co-written with son Owen King â€¢ Explores gender dynamics â€¢ 700+ pages long" },
            { Title: "The Outsider", Type: "Novel", Date: "May 2018", Category: "novel", Year: 2018,
              Plot: "A detective investigates a child murder where evidence points to an impossible suspect.",
              Facts: "Combines police procedural with supernatural horror â€¢ HBO series adaptation â€¢ Features Holly Gibney" },
            { Title: "The Institute", Type: "Novel", Date: "September 2019", Category: "novel", Year: 2019,
              Plot: "Psychic children are held captive in a secret facility where they're trained as weapons.",
              Facts: "Explores government conspiracy â€¢ Children with telepathic/telekinetic abilities â€¢ 561 pages" },
            { Title: "Billy Summers", Type: "Novel", Date: "August 3, 2021", Category: "novel", Year: 2021,
              Plot: "A hitman plans his final job while writing a book about his life, but complications arise.",
              Facts: "Explores PTSD and morality â€¢ Meta-fictional elements â€¢ 528 pages long" },
            { Title: "Later", Type: "Novel", Date: "March 2, 2021", Category: "novel", Year: 2021,
              Plot: "A boy who can see dead people gets involved in stopping a terrorist plot from beyond the grave.",
              Facts: "Published by Hard Case Crime â€¢ Explores childhood trauma â€¢ Supernatural thriller" },
            { Title: "Fairy Tale", Type: "Novel", Date: "September 6, 2022", Category: "novel", Year: 2022,
              Plot: "A teenager discovers a portal to a decaying fantasy world that he must help restore.",
              Facts: "King's return to pure fantasy â€¢ 608 pages â€¢ Inspired by classic fairy tales" },
            { Title: "Gwendy's Final Task", Type: "Novel", Date: "February 15, 2022", Category: "novel", Year: 2022,
              Plot: "Adult Gwendy faces a final confrontation with the mysterious button box aboard a space station.",
              Facts: "Third in Gwendy series â€¢ Co-written with Richard Chizmar â€¢ Space-based horror story" },
            { Title: "Holly", Type: "Novel", Date: "September 5, 2023", Category: "novel", Year: 2023,
              Plot: "Private detective Holly Gibney investigates the disappearance of two academics and uncovers a cannibalistic cult.",
              Facts: "Features returning character Holly Gibney â€¢ King's latest published novel â€¢ Detective thriller" },
            { Title: "Never Flinch", Type: "Novel", Date: "May 27, 2025", Category: "novel", Year: 2025,
              Plot: "Upcoming novel - plot details not yet revealed.",
              Facts: "King's next scheduled release â€¢ Title announced in 2024 â€¢ Details forthcoming" },

            // Dark Tower Series
            { Title: "The Dark Tower: The Gunslinger", Type: "Novel", Date: "June 1982", Category: "novel", Year: 1982,
              Plot: "The last gunslinger pursues the mysterious Man in Black across a post-apocalyptic wasteland.",
              Facts: "First Dark Tower book â€¢ Originally serialized in magazine â€¢ Revised and expanded in 2003" },
            { Title: "The Dark Tower: The Drawing of the Three", Type: "Novel", Date: "May 1987", Category: "novel", Year: 1987,
              Plot: "Roland draws three companions from modern-day New York through magical doors on a beach.",
              Facts: "Introduces Eddie, Susannah, and Jake â€¢ Time-travel elements â€¢ Connects to modern world" },
            { Title: "The Dark Tower: The Waste Lands", Type: "Novel", Date: "August 1991", Category: "novel", Year: 1991,
              Plot: "The ka-tet travels through a devastated city filled with dangerous technology and riddles.",
              Facts: "Features Blaine the Mono train â€¢ Jake's paradox resolved â€¢ Introduces Oy the billy-bumbler" },
            { Title: "The Dark Tower: Wizard and Glass", Type: "Novel", Date: "November 1997", Category: "novel", Year: 1997,
              Plot: "Roland tells his companions about his tragic first love and the fall of Gilead.",
              Facts: "Mostly flashback story â€¢ Shows Roland as young gunslinger â€¢ Features The Wizard of Oz connections" },
            { Title: "The Dark Tower: Wolves of the Calla", Type: "Novel", Date: "November 2003", Category: "novel", Year: 2003,
              Plot: "The ka-tet helps a farming community defend against robotic wolves who steal children.",
              Facts: "Homage to The Magnificent Seven â€¢ Introduces Father Callahan from 'Salem's Lot â€¢ Published after 6-year gap" },
            { Title: "The Dark Tower: Song of Susannah", Type: "Novel", Date: "June 2004", Category: "novel", Year: 2004,
              Plot: "Susannah is possessed while the ka-tet splits up to pursue different missions across worlds.",
              Facts: "Stephen King appears as character â€¢ Meta-fictional elements â€¢ Sets up final confrontation" },
            { Title: "The Dark Tower", Type: "Novel", Date: "September 2004", Category: "novel", Year: 2004,
              Plot: "Roland reaches the Dark Tower in this epic conclusion to his quest spanning multiple lifetimes.",
              Facts: "Controversial ending â€¢ King himself appears in story â€¢ Completes the wheel of ka" },
            { Title: "The Dark Tower: The Wind Through the Keyhole", Type: "Novel", Date: "April 2012", Category: "novel", Year: 2012,
              Plot: "Roland tells a story-within-a-story while the ka-tet shelters from a dangerous storm.",
              Facts: "Book 4.5 in the series â€¢ Standalone story â€¢ Returns to Mid-World after series completion" },

            // Richard Bachman Books
            { Title: "Rage", Type: "Bachman Novel", Date: "December 1976", Category: "bachman", Year: 1976,
              Plot: "A disturbed student holds his algebra class hostage after shooting his teacher.",
              Facts: "King's first published novel â€¢ Withdrawn from publication due to school shootings â€¢ Explores teenage alienation" },
            { Title: "The Long Walk", Type: "Bachman Novel", Date: "December 1978", Category: "bachman", Year: 1978,
              Plot: "100 teenage boys participate in a deadly walking contest where stopping means death.",
              Facts: "King considers it one of his best â€¢ Written when King was 18 â€¢ Dystopian nightmare scenario" },
            { Title: "Roadwork", Type: "Bachman Novel", Date: "December 1980", Category: "bachman", Year: 1980,
              Plot: "A man's life falls apart when highway construction threatens his home and business.",
              Facts: "Most realistic of Bachman books â€¢ Explores middle-class breakdown â€¢ Based on King's own experiences" },
            { Title: "The Running Man", Type: "Bachman Novel", Date: "December 1981", Category: "bachman", Year: 1981,
              Plot: "A desperate man joins a deadly game show where contestants are hunted for prize money.",
              Facts: "Predicted reality TV culture â€¢ Schwarzenegger film very different from book â€¢ Written in one week" },
            { Title: "Thinner", Type: "Bachman Novel", Date: "November 1984", Category: "bachman", Year: 1984,
              Plot: "An overweight lawyer is cursed by a gypsy to lose weight uncontrollably.",
              Facts: "Book that revealed Bachman's identity â€¢ King's exploration of consequences â€¢ Body horror elements" },
            { Title: "The Regulators", Type: "Bachman Novel", Date: "December 1995", Category: "bachman", Year: 1995,
              Plot: "Suburban neighborhood terrorized by supernatural forces controlling local children.",
              Facts: "Mirror universe version of Desperation â€¢ Same characters, different roles â€¢ Published same day as Desperation" },
            { Title: "Blaze", Type: "Bachman Novel", Date: "December 2006", Category: "bachman", Year: 2006,
              Plot: "A brain-damaged man kidnaps a baby while guided by his dead partner's voice.",
              Facts: "Found manuscript from 1970s â€¢ Heavily revised before publication â€¢ Of Mice and Men influence" },

            // Short Story Collections
            { Title: "Night Shift", Type: "Story Collection", Date: "February 1978", Category: "collection", Year: 1978,
              Plot: "King's first short story collection featuring classics like 'Children of the Corn' and 'The Boogeyman.'",
              Facts: "20 stories total â€¢ Launched King's short fiction career â€¢ Contains many adapted stories" },
            { Title: "Different Seasons", Type: "Story Collection", Date: "August 1982", Category: "collection", Year: 1982,
              Plot: "Four novellas including 'Rita Hayworth and Shawshank Redemption' and 'The Body.'",
              Facts: "All four stories adapted to film â€¢ Contains no supernatural elements â€¢ King's most acclaimed collection" },
            { Title: "Skeleton Crew", Type: "Story Collection", Date: "June 1985", Category: "collection", Year: 1985,
              Plot: "22 stories including 'The Mist,' 'Survivor Type,' and 'The Jaunt.'",
              Facts: "Mix of horror and science fiction â€¢ Contains poem 'Paranoid' â€¢ Features story notes by King" },
            { Title: "Four Past Midnight", Type: "Story Collection", Date: "September 1990", Category: "collection", Year: 1990,
              Plot: "Four novellas: 'The Langoliers,' 'Secret Window,' 'The Library Policeman,' and 'The Sun Dog.'",
              Facts: "All stories over 100 pages â€¢ Secret Window became film starring Johnny Depp â€¢ Explores time and reality" },
            { Title: "Nightmares & Dreamscapes", Type: "Story Collection", Date: "October 1993", Category: "collection", Year: 1993,
              Plot: "Collection of 24 stories ranging from horror to dark fantasy, including 'Dolan's Cadillac.'",
              Facts: "Most diverse King collection â€¢ Includes baseball story â€¢ TNT adapted several stories" },
            { Title: "Hearts in Atlantis", Type: "Story Collection", Date: "September 1999", Category: "collection", Year: 1999,
              Plot: "Five interconnected stories about the 1960s, Vietnam War, and growing up.",
              Facts: "Connects to Dark Tower mythology â€¢ Anthony Hopkins starred in 2001 film â€¢ King's meditation on the '60s" },
            { Title: "Everything's Eventual", Type: "Story Collection", Date: "March 2002", Category: "collection", Year: 2002,
              Plot: "14 stories including the Dark Tower tale 'The Little Sisters of Eluria.'",
              Facts: "First collection in 9 years â€¢ Mix of new and previously published â€¢ Dark Tower connection" },
            { Title: "Just After Sunset", Type: "Story Collection", Date: "November 2008", Category: "collection", Year: 2008,
              Plot: "13 stories exploring fear in everyday situations, including 'N.' and 'A Very Tight Place.'",
              Facts: "King's return to pure horror shorts â€¢ N. became online series â€¢ Explores modern anxieties" },
            { Title: "Full Dark, No Stars", Type: "Story Collection", Date: "November 2010", Category: "collection", Year: 2010,
              Plot: "Four dark novellas about ordinary people in extraordinary circumstances.",
              Facts: "King's darkest collection â€¢ No supernatural elements â€¢ Explores human evil" },
            { Title: "The Bazaar of Bad Dreams", Type: "Story Collection", Date: "November 2015", Category: "collection", Year: 2015,
              Plot: "20 stories with King's personal notes, ranging from horror to touching human drama.",
              Facts: "Each story has author's note â€¢ Mix of genres â€¢ Mile 81 connects to Dark Tower" },
            { Title: "If It Bleeds", Type: "Story Collection", Date: "April 2020", Category: "collection", Year: 2020,
              Plot: "Four novellas including the title story featuring Holly Gibney investigating supernatural murders.",
              Facts: "Features Holly Gibney â€¢ Published during COVID pandemic â€¢ Mr. Harrigan's Phone adapted by Netflix" },
            { Title: "You Like It Darker", Type: "Story Collection", Date: "May 2024", Category: "collection", Year: 2024,
              Plot: "King's latest collection of 12 stories exploring the darkness that lurks in ordinary life.",
              Facts: "King's newest collection â€¢ Mix of horror and literary fiction â€¢ Published at age 76" },

            // Novellas (standalone)
            { Title: "Cycle of the Werewolf", Type: "Novel", Date: "April 1985", Category: "novel", Year: 1985,
              Plot: "A small town is terrorized by werewolf attacks during each month of the year.",
              Facts: "Originally calendar project â€¢ Illustrated by Bernie Wrightson â€¢ Adapted as Silver Bullet film" },
            { Title: "The Green Mile: The Complete Serial Novel", Type: "Novel", Date: "October 2000", Category: "novel", Year: 2000,
              Plot: "Death row guards encounter John Coffey, a gentle giant with miraculous healing powers.",
              Facts: "Originally published in 6 parts â€¢ Tom Hanks starred in 1999 film â€¢ King's experiment in serial fiction" },
            { Title: "Blockade Billy", Type: "Novella", Date: "April 20, 2010", Category: "novella", Year: 2010,
              Plot: "An elderly man recounts the story of a mysterious baseball player from 1957.",
              Facts: "Baseball-themed horror â€¢ Published as standalone â€¢ Later included in collection" },
            { Title: "Elevation", Type: "Novella", Date: "October 30, 2018", Category: "novella", Year: 2018,
              Plot: "A man begins losing weight while maintaining his physical appearance, leading to unexpected consequences.",
              Facts: "King's exploration of prejudice â€¢ LGBTQ themes â€¢ No supernatural horror elements" },
            { Title: "Gwendy's Button Box", Type: "Novella", Date: "May 16, 2017", Category: "novella", Year: 2017,
              Plot: "A young girl receives a mysterious box with buttons that can grant wishes and cause disasters.",
              Facts: "Co-written with Richard Chizmar â€¢ First in Gwendy trilogy â€¢ Connects to Dark Tower mythology" },

            // Non-Fiction
            { Title: "Danse Macabre", Type: "Nonfiction", Date: "December 1980", Category: "nonfiction", Year: 1980,
              Plot: "King's analysis of horror in film and literature from 1950-1980.",
              Facts: "King's first non-fiction book â€¢ Essential horror criticism â€¢ Explores what scares us and why" },
            { Title: "Nightmares in the Sky", Type: "Nonfiction", Date: "December 1987", Category: "nonfiction", Year: 1987,
              Plot: "Photo book featuring gargoyles with King's accompanying text about these stone guardians.",
              Facts: "Coffee table book â€¢ Collaboration with photographer â€¢ King's fascination with Gothic architecture" },
            { Title: "Mid-Life Confidential", Type: "Nonfiction", Date: "December 1993", Category: "nonfiction", Year: 1993,
              Plot: "Tour diary of the Rock Bottom Remainders, a band of famous authors including King.",
              Facts: "Co-authored with Dave Barry and others â€¢ Rock and roll adventure â€¢ Authors behaving badly" },
            { Title: "On Writing: A Memoir of the Craft", Type: "Nonfiction", Date: "December 1999", Category: "nonfiction", Year: 1999,
              Plot: "Half memoir, half master class on the craft of writing from one of America's most successful authors.",
              Facts: "King's most acclaimed non-fiction â€¢ Essential for writers â€¢ Written after van accident" },
            { Title: "Faithful", Type: "Nonfiction", Date: "September 2005", Category: "nonfiction", Year: 2005,
              Plot: "King and Stewart O'Nan chronicle the Boston Red Sox's historic 2004 World Series championship season.",
              Facts: "Co-written with Stewart O'Nan â€¢ For Red Sox fans â€¢ Documents curse-breaking season" },
            { Title: "GUNS", Type: "Nonfiction", Date: "January 2013", Category: "nonfiction", Year: 2013,
              Plot: "King's essay on gun violence in America following the Sandy Hook Elementary School shooting.",
              Facts: "Political essay on gun control â€¢ Response to mass shooting â€¢ Controversial political stance" }
        ];

        let filteredBooks = [...stephenKingBooks];
        let currentFilter = 'all';

        // Update statistics
        function updateStats() {
            const stats = {
                total: stephenKingBooks.length,
                novels: stephenKingBooks.filter(book => book.Category === 'novel').length,
                collections: stephenKingBooks.filter(book => book.Category === 'collection').length,
                novellas: stephenKingBooks.filter(book => book.Category === 'novella').length,
                nonfiction: stephenKingBooks.filter(book => book.Category === 'nonfiction').length,
                bachman: stephenKingBooks.filter(book => book.Category === 'bachman').length,
                years: new Date().getFullYear() - 1974
            };

            document.getElementById('stats').innerHTML = `
                <div class="stat">
                    <span class="stat-number">${stats.total}</span>
                    <div class="stat-label">Total Books</div>
                </div>
                <div class="stat">
                    <span class="stat-number">${stats.novels}</span>
                    <div class="stat-label">Novels</div>
                </div>
                <div class="stat">
                    <span class="stat-number">${stats.collections}</span>
                    <div class="stat-label">Collections</div>
                </div>
                <div class="stat">
                    <span class="stat-number">${stats.novellas}</span>
                    <div class="stat-label">Novellas</div>
                </div>
                <div class="stat">
                    <span class="stat-number">${stats.nonfiction}</span>
                    <div class="stat-label">Non-Fiction</div>
                </div>
                <div class="stat">
                    <span class="stat-number">${stats.bachman}</span>
                    <div class="stat-label">Bachman Books</div>
                </div>
                <div class="stat">
                    <span class="stat-number">${stats.years}</span>
                    <div class="stat-label">Years Writing</div>
                </div>
            `;
        }

        // Display books with tooltip functionality
        function displayBooks(books) {
            const grid = document.getElementById('bookGrid');
            grid.innerHTML = books.map(book => `
                <div class="book-card ${book.Category}" 
                     onmouseenter="showTooltip(event, '${book.Title.replace(/'/g, "\\'")}', '${book.Plot ? book.Plot.replace(/'/g, "\\'") : 'Plot information coming soon!'}', '${book.Facts ? book.Facts.replace(/'/g, "\\'") : 'Published: ' + book.Date}')"
                     onmouseleave="hideTooltip()">
                    <div class="book-title">${book.Title}</div>
                    <div class="book-meta">
                        <span>${book.Date}</span>
                        <span class="book-type">${book.Type}</span>
                    </div>
                </div>
            `).join('');
        }

        // Filter books
        function filterBooks(category) {
            currentFilter = category;
            if (category === 'all') {
                filteredBooks = [...stephenKingBooks];
            } else {
                filteredBooks = stephenKingBooks.filter(book => book.Category === category);
            }
            displayBooks(filteredBooks);
            updateFilterButtons();
        }

        // Search books
        function searchBooks(query) {
            const searchTerm = query.toLowerCase();
            const searchResults = filteredBooks.filter(book => 
                book.Title.toLowerCase().includes(searchTerm)
            );
            displayBooks(searchResults);
        }

        // Update filter button states
        function updateFilterButtons() {
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.filter === currentFilter);
            });
        }

        // Download Excel file
        function downloadExcel(type) {
            try {
                const dataToExport = type === 'all' ? stephenKingBooks : filteredBooks;
                
                // Create workbook
                const wb = XLSX.utils.book_new();
                
                // Prepare data for export
                const exportData = dataToExport
                    .sort((a, b) => a.Year - b.Year)
                    .map(book => ({
                        Title: book.Title,
                        Type: book.Type,
                        Category: book.Category,
                        'Publication Date': book.Date,
                        Year: book.Year,
                        Plot: book.Plot || 'No plot summary available',
                        Facts: book.Facts || 'No additional facts available'
                    }));
                
                // Convert to worksheet
                const ws = XLSX.utils.json_to_sheet(exportData);
                
                // Set column widths
                ws['!cols'] = [
                    { wch: 50 }, // Title
                    { wch: 20 }, // Type
                    { wch: 15 }, // Category
                    { wch: 20 }, // Date
                    { wch: 10 }, // Year
                    { wch: 80 }, // Plot
                    { wch: 60 }  // Facts
                ];
                
                // Add worksheet to workbook
                XLSX.utils.book_append_sheet(wb, ws, "Stephen King Books");
                
                // Generate filename
                const filename = type === 'all' 
                    ? 'stephen_king_complete_bibliography.xlsx'
                    : `stephen_king_${currentFilter}_books.xlsx`;
                
                // Download file
                XLSX.writeFile(wb, filename);
                
                // Visual feedback
                const btn = document.querySelector(`[onclick="downloadExcel('${type}')"]`);
                const originalText = btn.textContent;
                btn.textContent = 'âœ… Downloaded!';
                btn.style.background = 'linear-gradient(45deg, #27ae60, #2ecc71)';
                
                setTimeout(() => {
                    btn.textContent = originalText;
                    btn.style.background = 'linear-gradient(45deg, #4ecdc4, #44a08d)';
                }, 2000);
                
            } catch (error) {
                console.error('Error creating Excel file:', error);
                alert('Error creating Excel file. Please try again.');
            }
        }

        // Tooltip functions
        let tooltip = null;

        function showTooltip(event, title, plot, facts) {
            // Create tooltip if it doesn't exist
            if (!tooltip) {
                tooltip = document.createElement('div');
                tooltip.className = 'book-tooltip';
                document.body.appendChild(tooltip);
            }

            // Set tooltip content
            const factsList = facts.split(' â€¢ ').map(fact => `â€¢ ${fact}`).join('<br>');
            tooltip.innerHTML = `
                <div class="tooltip-title">${title}</div>
                <div class="tooltip-plot">${plot}</div>
                <div class="tooltip-facts">${factsList}</div>
            `;

            // Position tooltip
            const rect = event.target.closest('.book-card').getBoundingClientRect();
            tooltip.style.left = Math.min(event.clientX + 15, window.innerWidth - 370) + 'px';
            tooltip.style.top = (rect.top - 10) + 'px';

            // Show tooltip
            tooltip.classList.add('show');
        }

        function hideTooltip() {
            if (tooltip) {
                tooltip.classList.remove('show');
            }
        }

        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            updateStats();
            displayBooks(stephenKingBooks);
            
            // Filter button event listeners
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.addEventListener('click', () => filterBooks(btn.dataset.filter));
            });
            
            // Search box event listener
            document.getElementById('searchBox').addEventListener('input', (e) => {
                searchBooks(e.target.value);
            });
        });
    </script>
</body>
</html>